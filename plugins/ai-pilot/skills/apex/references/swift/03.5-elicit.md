---
name: 03.5-elicit
description: Swift expert self-review using elicitation techniques
prev_step: references/swift/03-execution.md
next_step: references/swift/04-validation.md
---

# 03.5-elicit - Swift Expert Self-Review

Swift expert self-reviews code using elicitation techniques before sniper validation.

---

## Swift Specific Techniques

### Auto-Detection for Swift Code

| Code Type | Auto-Selected Techniques |
|-----------|--------------------------|
| SwiftUI Views | ARCH-01 (SOLID), UX-01 (a11y), ARCH-04 (Size) |
| ViewModels | CONC-01 (@MainActor), TEST-01 (Edge), ARCH-02 (DI) |
| Services | ARCH-01 (Protocol), TEST-02 (Error), SEC-01 (Keychain) |
| Async/Await | CONC-01 (Task), CONC-02 (Cancellation), TEST-01 (Edge) |
| SwiftData | DATA-02 (Migration), PERF-01 (Fetch), CONC-06 (Context) |
| Networking | SEC-01 (TLS), INT-05 (Timeout), INT-06 (Retry) |

---

## Swift 6 Priority Checks

### 1. Concurrency Safety
```text
â–¡ @MainActor for UI updates
â–¡ Sendable conformance for shared types
â–¡ Actor isolation for shared state
â–¡ Task cancellation handling
```

### 2. SwiftUI Best Practices
```text
â–¡ Small, focused views (<100 lines)
â–¡ Extract subviews for reusability
â–¡ @Observable for state (not ObservableObject)
â–¡ Preview providers for all views
```

### 3. Protocol-Oriented Design
```text
â–¡ Protocols in dedicated files
â–¡ Protocol extensions for defaults
â–¡ Dependency injection via protocols
â–¡ Mock-friendly architecture
```

### 4. Memory Management
```text
â–¡ [weak self] in closures
â–¡ No retain cycles
â–¡ Proper Task cancellation
â–¡ @State/@StateObject ownership
```

---

## Technique Quick Reference (Swift)

| ID | Technique | Swift Focus |
|----|-----------|-------------|
| ARCH-01 | SOLID | Protocol-oriented, single responsibility |
| ARCH-04 | File Size | <100 lines per view/type |
| CONC-01 | Concurrency | @MainActor, Sendable, actors |
| CONC-02 | Cancellation | Task.checkCancellation() |
| UX-01 | Accessibility | .accessibilityLabel, VoiceOver |
| TEST-01 | Edge Cases | Preview scenarios, empty states |
| SEC-01 | Security | Keychain, secure storage |
| PERF-01 | Fetch | SwiftData batch fetching |
| DATA-02 | Migration | SwiftData schema versioning |
| DOC-03 | Documentation | /// comments on public APIs |

---

## Example: ViewModel Review

```swift
// Before elicitation
class UserViewModel: ObservableObject {
    @Published var users: [User] = []

    func load() {
        Task {
            users = try await api.fetchUsers()
        }
    }
}

// After CONC-01 + TEST-01 + ARCH-01
@MainActor
@Observable
final class UserViewModel {
    private(set) var users: [User] = []
    private(set) var isLoading = false
    private(set) var error: Error?

    private let userService: UserServiceProtocol

    init(userService: UserServiceProtocol = UserService()) {
        self.userService = userService
    }

    func load() async {
        isLoading = true
        error = nil

        do {
            users = try await userService.fetchUsers()
        } catch {
            self.error = error
        }

        isLoading = false
    }
}
```

---

## Output Format

```text
## ðŸŸ£ Swift Elicitation Report

Framework: Swift 6 / SwiftUI
Mode: auto
Code Type: ViewModel

### Applied Techniques
1. CONC-01: Concurrency â†’ Added @MainActor
2. TEST-01: Edge Cases â†’ Added loading/error states
3. ARCH-01: SOLID â†’ Protocol injection, @Observable

### Corrections Made
- Changed to @Observable (Swift 6)
- Added @MainActor for thread safety
- Added loading and error states
- Injected UserServiceProtocol for testing

â†’ Ready for 04-validation (sniper)
```

---

## Next Step

â†’ `04-validation.md`: sniper with Swift linters (SwiftLint, swift-format)
