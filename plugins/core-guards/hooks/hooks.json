{
  "_description": "Core Guards - Security and SOLID enforcement hooks",
  "_version": "1.0.0",
  "_author": "fusengine-plugins",

  "hooks": {
    "PreToolUse": [
      {
        "_description": "Git & Install & Security & Write guards for Bash commands",
        "matcher": "Bash",
        "hooks": [
          {
            "_description": "Block Bash file writes (python -c, sed -i, redirects) â€” forces Edit/Write tools",
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/pre-tool-use/bash-write-guard.py"
          },
          {
            "_description": "Block destructive git commands (push --force, reset --hard, etc.)",
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/pre-tool-use/git-guard.py"
          },
          {
            "_description": "Ask confirmation before installing packages (npm, pip, brew, etc.)",
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/pre-tool-use/install-guard.py"
          },
          {
            "_description": "Validate dangerous commands via security rules",
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/pre-tool-use/security-guard.py"
          }
        ]
      },
      {
        "_description": "Pre-commit validation (linters, tests) before git commit",
        "matcher": "Bash",
        "hooks": [
          {
            "_description": "Run ESLint, TypeScript, Prettier, Ruff before commit",
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/pre-tool-use/pre-commit-guard.py"
          }
        ]
      },
      {
        "_description": "SOLID: Enforce interface separation in component files",
        "matcher": "Write|Edit",
        "hooks": [
          {
            "_description": "Block interfaces/types in .tsx/.jsx/.vue files - must be in src/interfaces/",
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/pre-tool-use/enforce-interfaces.py"
          }
        ]
      },
      {
        "_description": "SOLID: Block edits to files > 100 lines - must split first",
        "matcher": "Write|Edit",
        "hooks": [
          {
            "_description": "PreToolUse blocker for oversized files",
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/pre-tool-use/enforce-file-size.py"
          }
        ]
      },
      {
        "_description": "SOLID: Require reading SOLID principles before coding",
        "matcher": "Write|Edit",
        "hooks": [
          {
            "_description": "Block code modifications if SOLID rules not read",
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/pre-tool-use/require-solid-read.py"
          }
        ]
      }
    ],

    "PostToolUse": [
      {
        "_description": "Track file reads (documentation and SOLID references)",
        "matcher": "Read",
        "hooks": [
          {
            "_description": "Auto-document important file reads to task docs",
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/post-tool-use/auto-document-reads.py"
          },
          {
            "_description": "Record when SOLID principles are read for session verification",
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/post-tool-use/track-solid-reads.py"
          }
        ]
      },
      {
        "_description": "SOLID validation and session tracking after file modifications",
        "matcher": "Write|Edit",
        "hooks": [
          {
            "_description": "SOLID: Block files exceeding 100 lines - must split into modules",
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/post-tool-use/enforce-file-size.py"
          },
          {
            "_description": "Track cumulative code file changes per session for sniper trigger",
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/post-tool-use/track-session-changes.py"
          },
          {
            "_description": "Post-edit TypeScript validation",
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/post-tool-use/post-edit-typescript.py"
          }
        ]
      }
    ],

    "SessionStart": [
      {
        "_description": "Session initialization - load context and cleanup stale states",
        "matcher": "",
        "hooks": [
          {
            "_description": "Inject CLAUDE.md content into session context",
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/session-start/inject-claude-md.py"
          },
          {
            "_description": "Load development context (git status, project type detection)",
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/session-start/load-dev-context.py"
          },
          {
            "_description": "Cleanup stale session state files from /tmp",
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/session-start/cleanup-session-states.py"
          }
        ]
      }
    ],

    "UserPromptSubmit": [
      {
        "_description": "Process user prompt - detect APEX triggers and inject rules",
        "matcher": "",
        "hooks": [
          {
            "_description": "Read CLAUDE.md + auto-detect if APEX workflow should be triggered",
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/user-prompt/read-claude-md.py"
          }
        ]
      }
    ],

    "SubagentStop": [
      {
        "_description": "Track sub-agent completion and memory",
        "matcher": "",
        "hooks": [
          {
            "_description": "Track agent memory and completion for context persistence",
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/subagent-stop/track-agent-memory.py"
          }
        ]
      }
    ],

    "Stop": [
      {
        "_description": "Sound notification when Claude finishes responding (not on user interrupt)",
        "matcher": "",
        "hooks": [
          {
            "_description": "Play task completion sound",
            "type": "command",
            "command": "afplay ${CLAUDE_PLUGIN_ROOT}/song/finish.mp3"
          }
        ]
      }
    ],

    "PermissionRequest": [
      {
        "_description": "Sound for ALL permission dialogs (system + hook-triggered)",
        "matcher": "",
        "hooks": [
          {
            "_description": "Play permission request sound",
            "type": "command",
            "command": "afplay ${CLAUDE_PLUGIN_ROOT}/song/permission-need.mp3"
          }
        ]
      }
    ],

    "PreCompact": [
      {
        "_description": "Save APEX state before context compression",
        "matcher": "",
        "hooks": [
          {
            "_description": "Persist current task state and decisions to .claude/apex/",
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/pre-compact/save-apex-state.py"
          }
        ]
      }
    ],

    "SessionEnd": [
      {
        "_description": "Cleanup session and save stats",
        "matcher": "",
        "hooks": [
          {
            "_description": "Remove temp files and save session statistics",
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/session-end/cleanup-session.py"
          }
        ]
      }
    ],

    "Setup": [
      {
        "_description": "First-run validation on plugin installation",
        "matcher": "",
        "hooks": [
          {
            "_description": "Validate API keys and dependencies are configured",
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/setup/validate-setup.py"
          }
        ]
      }
    ],

    "Notification": [
      {
        "_description": "Sound for permission requests (Bash, Write, Edit confirmations)",
        "matcher": "permission_prompt",
        "hooks": [
          {
            "_description": "Play permission request sound",
            "type": "command",
            "command": "afplay ${CLAUDE_PLUGIN_ROOT}/song/permission-need.mp3"
          }
        ]
      },
      {
        "_description": "Sound when Claude waits for user input (60+ sec idle)",
        "matcher": "idle_prompt",
        "hooks": [
          {
            "_description": "Play idle/waiting sound",
            "type": "command",
            "command": "afplay ${CLAUDE_PLUGIN_ROOT}/song/need-human.mp3"
          }
        ]
      },
      {
        "_description": "Sound for MCP tool elicitation dialogs",
        "matcher": "elicitation_dialog",
        "hooks": [
          {
            "_description": "Play elicitation dialog sound",
            "type": "command",
            "command": "afplay ${CLAUDE_PLUGIN_ROOT}/song/need-human.mp3"
          }
        ]
      }
    ]
  }
}
